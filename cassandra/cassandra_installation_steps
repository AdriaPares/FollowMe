# For now following a mixture of these steps. Added for reference, detailed steps are below

# https://cassandra.apache.org/download/

# https://github.com/InsightDataScience/data-engineering-ecosystem/wiki/Cassandra

# For more info on designing your Cassandra cluster, you can look at: https://www.ecyrd.com/cassandracalculator/

# but using my default .yaml and rackdc.properties (research this last one, no idea about what this means or does).

# If sshing fails, do: (hostname is ec2-x-xx-xxx.....) and try again

ssh-keygen -R hostname

#DETAILED STEPS

sudo apt-get update
sudo apt install openjdk-8-jre -y

# change 311x accordingly. Run as 311x!!
echo "deb http://www.apache.org/dist/cassandra/debian 311x main" | sudo tee -a /etc/apt/sources.list.d/cassandra.sources.list



curl https://www.apache.org/dist/cassandra/KEYS | sudo apt-key add -

sudo apt-get update

sudo apt-get install cassandra -y [probably add -y]

# cassandra will be in /etc/cassandra, and it will start automatically.

vi ~/.profile

# Add the following:
# Cassandra
export CASSANDRA_HOME=/etc/cassandra
export PATH=$PATH:$CASSANDRA_HOME/bin

source ~/.profile

# You can check with env if it's correctly set up.

# Edit .yaml files

sudo service cassandra stop # Otherwise we can't change configuration.

sudo vi /etc/cassandra/cassandra.yaml

# Change the following lines:

[
seeds: "10.0.0.5,10.0.0.7,10.0.0.12,10.0.0.19" # With your private IPs
listen_address: the node's private IP (should be one of the seeds typically)
rpc_address: the node's private IP (should be one of the seeds typically)
endpoint_snitch: Ec2Snitch # Should be Ec2MultiRegionSnitch if you want multiple regions (too much for this project)

# Launch cassandra (this way is proooobably wrong):

sudo cassandra -R -Dcassandra.ignore_dc=true -Dcassandra.ignore_rack=true

# You should see HANDSHAKE popping up, with the IPs of the other nodes. This means it's cool.

# Test if it's up:

cqlsh 10.0.0.9 (or node's private ip).

# We can log into other nodes as well by picking their IPs

#THESE DON'T WORK
sudo add-apt-repository ppa:webupd8team/java
sudo apt-get update
sudo apt-get install oracle-java8-installer

# We can see the status of the cluster with

nodetool status

###### TESTING ZONE ########

# Apparently cassandra.yaml is a gold mine of stuff we can tune. Here are some interesting places to look into:

# concurrent reads/writes -> This can potentially be more than the default of 32 with our setup
# strategy for optimizing disk read
#



https://www.liquidweb.com/kb/install-cassandra-ubuntu-16-04-lts/